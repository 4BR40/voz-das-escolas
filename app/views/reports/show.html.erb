<div class="flex-container mt-3">
  <div class="align-center">
    <h3><i class="fas fa-map-marker-alt"></i> <%= current_user.school.name %></h3>
  </div>

  <br>
  <div class="container">
    <div class="row justify-content-center">
      <div>
        <% if current_user.school == @report.school %>
          <div class="card" style="width: 19rem; margin-bottom: 24px;">
            <% if @report.photos.attached?  %>
              <%= cl_image_path @report.photo.key, class: card-img-top %>
            <% else %>
              <img class="card-img-top" src="https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/skateboard.jpg" />
            <% end %>
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <h4 class="card-text" style="width: 17rem"><strong><%= @report.category.name %></strong></h4>
                <%= link_to '<i class="fas fa-edit fa-2x"></i>'.html_safe, edit_report_path(@report) if current_user == @report.user %>
              </div>
              <% if @report.solved? %>
                <p>ðŸŸ¢ Resolvido </p>
              <% else %>
                <p>ðŸŸ  Pendente </p>
              <% end %>
              <div class="d-flex justify-content-between">
                <p>ðŸ’¬ <strong><%= @report.user.name %></strong></p>
                <% if (Date.today.day - @report.created_at.day) == 0 %>
                  <p>ðŸ•’ Hoje </p>
                <% elsif (Date.today.day - @report.created_at.day) == 1 %>
                  <p>ðŸ•’ Ontem </p>
                <% else %>
                  <p>ðŸ•’ HÃ¡ <%= (Date.today.day - @report.created_at.day) %> dias</p>
                <% end %>
              </div>
              <p class="card-text" style="width: 17rem;"><%= @report.description %></p>
              <h6><strong>ComentÃ¡rios:</strong></h6>
              <ul class="list-group">
                <% @report.reviews.each do |review| %>
                  <% if current_user == review.user %>  
                    <li class="list-group-item">
                      <div class="d-flex justify-content-between">
                        <strong>ðŸ’¬ <%= review.user.name %></strong>
                        <% if (Date.today.day - review.created_at.day) > 1 %>
                          <p>ðŸ•’ HÃ¡ <%= (Date.today.day - review.created_at.day) %> dias</p>
                        <% elsif (Date.today.day - review.created_at.day) == 1 %>
                          <p>ðŸ•’ Ontem </p>
                        <% else %>
                          <p>ðŸ•’ Hoje </p>
                        <% end %>
                      </div>
                      <em><%= review.comment %></em>
                      <div class="d-flex justify-content-around" style="font-size: 8px;">
                        <%= link_to '<i class="fas fa-trash fa-2x"></i>'.html_safe, review_path(review), method: :delete %>
                        <%= link_to '<i class="fas fa-edit fa-2x"></i>'.html_safe, edit_review_path(review) %>
                      </div>
                    </li>
                  <% else %>
                    <li class="list-group-item">
                      <div class="d-flex justify-content-between">
                        <strong>ðŸ’¬ <%= review.user.name %></strong>
                        <% if (Date.today.day - review.created_at.day) > 1 %>
                          <p>ðŸ•’ HÃ¡ <%= (Date.today.day - review.created_at.day) %> dias</p>
                        <% elsif (Date.today.day - review.created_at.day) == 1 %>
                          <p>ðŸ•’ Ontem </p>
                        <% else %>
                          <p>ðŸ•’ Hoje </p>
                        <% end %>
                      </div>
                      <em><%= review.comment %></em>
                    </li>
                  <% end %>
                <% end %>
                <div>
                  <% if @review.new_record? %>
                    <%= simple_form_for [@report, @review] do |f| %>
                      <div class="form-list">
                        <%= f.input :comment, label: 'O que vocÃª pensa sobre este problema?' %>
                      </div>
                      <div align="center">
                        <%= f.submit "Comentar", class: "btn btn-primary" %>
                      </div>
                    <% end %>
                  <% else %>
                    <%= simple_form_for @review, url: review_path(@review), html: {method: "patch"} do |f| %>
                      <div class="form-list">
                        <%= f.input :comment, label: 'O que vocÃª pensa sobre este problema?' %>
                      </div>
                      <div align="center">
                        <%= f.submit "Comentar", class: "btn btn-primary" %>
                      </div>
                    <% end %>
                  <% end %>
                </div>
              </ul>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
  
  <br>

  <div class="align-center">
    <%= link_to "Informe um problema", new_school_report_path(@report.school_id), class: "btn btn-info" %>
  </div>
</div>
